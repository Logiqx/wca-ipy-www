function debugMessage(c,b){var a="";a+="<h2>Houston, we have a problem</h2>";a+="<h3>Browser</h3><p>You need at least Chrome 1, Firefox 4, IE8, Safari 4 or Opera 10</p>";a+="<h3>Debug</h3><p>"+c+": "+b+"</p>";return a}function parameterMessage(c,b){var a="";a+="<h2>Hello, I'm Sorry...</h2>";a+="<p>Unrecognised "+c+" specified in the URL - "+b+"</p>";return a}function header(){var a="";if(getViewportWidth()<IPHONE_LANDSCAPE){a+="<p>Tip: Best viewed in landscape mode on mobile phones and some tablets.</p>"}return a}function footer(){var a="";return a}var COMMON_LANDSCAPE=1280;var COMMON_PORTRAIT=720;var IPAD_LANDSCAPE=1024;var IPAD_PORTRAIT=768;var GALAXY_S3_LANDSCAPE=640;var GALAXY_S3_PORTRAIT=360;var IPHONE_LANDSCAPE=480;var IPHONE_PORTRAIT=320;function getViewportWidth(){return document.documentElement.clientWidth}function getViewportHeight(){return document.documentElement.clientHeight}var eventIdx=null;var personIdx=null;var countryIdx=null;var competitionIdx=null;function getEventIdx(){if(eventIdx==null){eventIdx={};for(var a=0;a<rankings.events.length;a++){eventIdx[rankings.events[a].id]=a}}return eventIdx}function getPersonIdx(){if(personIdx==null){personIdx={};for(var a=0;a<rankings.persons.length;a++){personIdx[rankings.persons[a].id]=a}}return personIdx}function getCountryIdx(){if(countryIdx==null){countryIdx={};for(var a=0;a<rankings.countries.length;a++){countryIdx[rankings.countries[a].id]=a}}return countryIdx}function getCompetitionIdx(){if(competitionIdx==null){competitionIdx={};for(var b=0;b<rankings.competitions.length;b++){competitionIdx[rankings.competitions[b].id]=b;var a=new Date();rankings.competitions[b].age=(a-Date.parse(rankings.competitions[b].startDate))/86400000}}return competitionIdx}function addEventHandler(d,b,c){var a="on"+b;if(b=="hashchange"&&!(a in d)){hashChangeFallback(d,c)}else{if(d.addEventListener){d.addEventListener(b,c,false)}else{if(d.attachEvent){d.attachEvent(a,c)}}}}function hashChangeFallback(b,a){b.onhashchange=a;(function(e){var c=e.location,d=c.href,f=c.hash;setInterval(function(){var h=c.href,g=c.hash;if(g!=f&&typeof e.onhashchange==="function"){e.onhashchange({type:"hashchange",oldURL:d,newURL:h});d=h;f=g}},100)})(window)}var lastHash="n/a";var lastWidth=getViewportWidth();function renderPage(e){try{var d=false;if(e!=lastHash){d=true}else{if(e=="random"){d=true}}var a=getViewportWidth();if(a!=lastWidth){d=true}if(d){var h=getEventIdx();var g=getPersonIdx();var f=e.substring(1).split("-");if(f[0].length==0||h.hasOwnProperty(f[0])){renderRankings(f,a)}else{if(f[0]=="random"||g.hasOwnProperty(f[0])){renderPerson(f,a)}else{var c=parameterMessage("event or person",f[0]);document.getElementById("container").innerHTML=c}}lastHash=e;lastWidth=a}}catch(b){var c=debugMessage("renderPage",b.message);document.getElementById("container").innerHTML=c}}function hashChangeHandler(){try{var c=window.location.hash;renderPage(c)}catch(b){var a=debugMessage("hashChangeHandler",b.message);document.getElementById("container").innerHTML=a}}function resizeHandler(){try{var c=lastHash;renderPage(c)}catch(b){var a=debugMessage("resizeHandler",b.message);document.getElementById("container").innerHTML=a}}function popStateHandler(d){try{if(d.state!=null){var c=d.state.hash;renderPage(c);setTimeout(function(){window.scrollTo(d.state.xOffset,d.state.yOffset)},1)}else{var c=window.location.hash;renderPage(c)}}catch(b){var a=debugMessage("popStateHandler",b.message);document.getElementById("container").innerHTML=a}}function polyfillIndexOf(){if(!Array.prototype.indexOf){Array.prototype.indexOf=function(c,d){var b;if(this==null){throw new TypeError('"this" is null or not defined')}var e=Object(this);var a=e.length>>>0;if(a===0){return -1}var f=d|0;if(f>=a){return -1}b=Math.max(f>=0?f:a-Math.abs(f),0);while(b<a){if(b in e&&e[b]===c){return b}b++}return -1}}}function loadHandler(){try{polyfillIndexOf();addEventHandler(window,"hashchange",hashChangeHandler);addEventHandler(window,"resize",resizeHandler);addEventHandler(window,"popstate",popStateHandler);hashChangeHandler()}catch(b){var a=debugMessage("loadHandler",b.message);document.getElementById("container").innerHTML=a}}function storeWindowOffset(){try{var c={hash:lastHash,xOffset:window.pageXOffset,yOffset:window.pageYOffset};var d=document.title;var a=window.location.href;history.replaceState(c,d,a)}catch(b){}}function switchView(){storeWindowOffset();var a=document.getElementById("eventId");var b=a.options[a.selectedIndex].value;var j=document.getElementById("resultType");var g=j.options[j.selectedIndex].value;var o=document.getElementById("ageCategory");var f=o.options[o.selectedIndex].value;var k=document.getElementById("continentId");var d=k.options[k.selectedIndex].value.toLowerCase();var m=document.getElementById("countryId");var n=m.options[m.selectedIndex].value.toLowerCase();var i="#";if(n!="xx"){i+=b+"-"+g+"-"+f+"-"+d+"-"+n}else{if(d!="xx"){i+=b+"-"+g+"-"+f+"-"+d}else{if(f>40){i+=b+"-"+g+"-"+f}else{if(g!="single"){i+=b+"-"+g}else{i+=b}}}}try{if(navigator.userAgent.indexOf("Chrome/5.0")>-1){throw"Chrome/5.0"}var p=getEventIdx();var h={hash:i,xOffset:window.pageXOffset,yOffset:window.pageYOffset};var l=rankings.events[p[b]]+" - "+selectElement.options[selectElement.selectedIndex].text;var c=i;history.pushState(h,l,c);renderPage(i)}catch(e){window.location.hash=i}}addEventHandler(window,"load",loadHandler);function renderPerson(e,c){var b="";var a=getPersonIds();if(e[0]=="random"){personId=a[Math.floor(Math.random()*a.length)]}else{personId=e[0]}if(a.indexOf(personId)>=0){var d=rankings.persons[a.indexOf(personId)];b+="<h2>"+d.name+"</h2>";document.title=d.name;b+=e;b+=header();b+=footer()}else{b+=parameterMessage("person",personId)}document.getElementById("container").innerHTML=b};function renderOptions(k,g,d,b,p,o){var c=getEventIdx();var n=navigator.userAgent.indexOf("iPhone")>=0?"dd16":"dd14";var r="";if(n=="dd16"&&o>=COMMON_PORTRAIT||n=="dd14"&&o>=GALAXY_S3_LANDSCAPE){r+='<div class="'+n+'"><p><table><tr><th>Event:</th><th>Result:</th><th>Age:</th><th>Continent:</th><th>Country:</th></tr><tr>'}else{if(o>=GALAXY_S3_PORTRAIT){r+='<div class="'+n+'"><p><table><tr><th>Event:</th><th>Result:</th><th>Age:</th></tr><tr>'}}var e=filterEventIds(g,d,b,p);if(o<GALAXY_S3_PORTRAIT){r+='<div class="'+n+'"><table><tr><th>Event:</th>'}r+='<td class="event"><select id="eventId" onChange="switchView()">';for(var q=0;q<e.length;q++){var a=rankings.events[c[e[q]]];r+='<option value="'+a.id+'"';if(a.id==k){r+=" selected"}r+=">"+a.name+"</option>"}r+="</select></td>";var s=filterResultTypes(k,d,b,p);if(o<GALAXY_S3_PORTRAIT){r+="</tr><tr><th>Result:</th>"}r+='<td class="result"><select id="resultType" onChange="switchView()">';for(var q=0;q<s.length;q++){r+='<option value="'+s[q]+'"';if(s[q]==g){r+=" selected"}r+=">"+s[q].charAt(0).toUpperCase()+s[q].slice(1)+"</option>"}r+="</select></td>";var h=filterAgeCategories(k,g,b,p);if(o<GALAXY_S3_PORTRAIT){r+="</tr><tr><th>Age:</th>"}r+='<td class="age"><select id="ageCategory" onChange="switchView()">';for(var q=0;q<h.length;q++){r+='<option value="'+h[q]+'"';if(h[q]==d){r+=" selected"}r+=">Over "+h[q]+"</option>"}r+="</select></td>";if(n=="dd16"&&o<COMMON_PORTRAIT&&o>=GALAXY_S3_PORTRAIT||n=="dd14"&&o<GALAXY_S3_LANDSCAPE&&o>=GALAXY_S3_PORTRAIT){r+='</tr></table></p></div><div class="'+n+'"><p><table><tr><th>Continent:</th><th>Country:</th></tr><tr>'}var l=filterContinents(k,g,d,p);if(o<GALAXY_S3_PORTRAIT){r+="</tr><tr><th>Continent:</th>"}r+='<td class="continent"><select id="continentId" onChange="switchView()">';r+='<option value="xx"';if(b=="xx"){r+=" selected"}r+=">All Continents</option>";for(var q=0;q<rankings.continents.length;q++){var f=rankings.continents[q];if(l.indexOf(rankings.continents[q].id)>=0){r+='<option value="'+rankings.continents[q].id+'"';if(rankings.continents[q].id==b){r+=" selected"}r+=">"+rankings.continents[q].name+"</option>"}}r+="</select></td>";var j=filterCountries(k,g,d,b);if(o<GALAXY_S3_PORTRAIT){r+="</tr><tr><th>Country:</th>"}r+='<td class="country"><select id="countryId" onChange="switchView()">';r+='<option value="xx"';if(p=="xx"){r+=" selected"}r+=">All Countries</option>";for(var q=0;q<rankings.countries.length;q++){if(j.indexOf(rankings.countries[q].id)>=0){var m=rankings.countries[q];r+='<option value="'+rankings.countries[q].id+'"';if(rankings.countries[q].id==p){r+=" selected"}r+=">"+rankings.countries[q].name+"</option>"}}r+="</select></td></tr></table></p></div>";return r}function filterEventIds(f,e,a,k){var b=[];var o=getPersonIdx();var d=getCountryIdx();for(var n=0;n<rankings.events.length;n++){var i=rankings.events[n];for(var j=0;j<rankings.events[n].rankings.length;j++){var c=rankings.events[n].rankings[j];if(c.type==f&&c.age==e){for(var m=0;m<c.ranks.length;m++){var h=c.ranks[m];var g=rankings.persons[o[h.id]];var l=rankings.countries[d[g.country]];if((a=="XX"||l.continent==a)&&(k=="XX"||g.country==k)){b.push(i.id);break}}}if(b.indexOf(i.id)>=0){break}}}return b}function filterResultTypes(a,e,b,j){var k=[];var n=getEventIdx();var o=getPersonIdx();var d=getCountryIdx();var h=rankings.events[n[a]];for(var i=0;i<h.rankings.length;i++){var c=h.rankings[i];if(c.age==e&&k.indexOf(c.type)<0){for(var m=0;m<c.ranks.length;m++){var g=c.ranks[m];var f=rankings.persons[o[g.id]];var l=rankings.countries[d[f.country]];if((b=="XX"||l.continent==b)&&(j=="XX"||f.country==j)){k.push(c.type);break}}}}if(k.indexOf("average")>=0&&k.indexOf("single")>=0){k=["single","average"]}return k}function filterAgeCategories(a,e,b,j){var k=[];var n=getEventIdx();var o=getPersonIdx();var d=getCountryIdx();var h=rankings.events[n[a]];for(var i=0;i<h.rankings.length;i++){var c=h.rankings[i];if(c.type==e&&k.indexOf(c.age)<0){for(var m=0;m<c.ranks.length;m++){var g=c.ranks[m];var f=rankings.persons[o[g.id]];var l=rankings.countries[d[f.country]];if((b=="XX"||l.continent==b)&&(j=="XX"||f.country==j)){k.push(c.age);break}}}}return k}function filterContinents(a,e,d,j){var k=[];var n=getEventIdx();var o=getPersonIdx();var c=getCountryIdx();var h=rankings.events[n[a]];for(var i=0;i<h.rankings.length;i++){var b=h.rankings[i];if(b.type==e&&b.age==d){for(var m=0;m<b.ranks.length;m++){var g=b.ranks[m];var f=rankings.persons[o[g.id]];var l=rankings.countries[c[f.country]];if((j=="XX"||f.country==j)&&k.indexOf(l.continent)<0){k.push(l.continent)}}}}return k}function filterCountries(a,f,e,b){var l=[];var n=getEventIdx();var o=getPersonIdx();var d=getCountryIdx();var i=rankings.events[n[a]];for(var j=0;j<i.rankings.length;j++){var c=i.rankings[j];if(c.type==f&&c.age==e){for(var m=0;m<c.ranks.length;m++){var h=c.ranks[m];var g=rankings.persons[o[h.id]];var k=rankings.countries[d[g.country]];if((b=="XX"||k.continent==b)&&l.indexOf(k.id)<0){l.push(k.id)}}}}return l}function renderTable(l,h,e,c,s,q){var y="";var d=getEventIdx();var A=getPersonIdx();var t=getCountryIdx();var u=getCompetitionIdx();var a=rankings.events[d[l]];for(var g=0;g<a.rankings.length;g++){var f=a.rankings[g];if(f.type==h&&f.age==e){y+='<div class="rankings"><table>';y+="<tr>";y+='<th class="rank">Rank</th>';y+="<th>Name</th>";y+='<th class="result">Result</th>';if(q>=IPHONE_LANDSCAPE){y+='<th class="country">Citizen of</th>'}if(q>=IPAD_LANDSCAPE){y+='<th class="competition">Competition</th>'}y+="</tr>";var w=-1;var k=1;if(s!="XX"){if(f.missing.countries.hasOwnProperty(s)){w=f.missing.countries[s];if(f.missing.hasOwnProperty("world")&&f.missing.world>0){k=w/f.missing.world}}}else{if(c!="XX"){if(f.missing.continents.hasOwnProperty(c)){w=f.missing.continents[c];if(f.missing.hasOwnProperty("world")&&f.missing.world>0){k=w/f.missing.world}}}else{if(f.missing.hasOwnProperty("world")){w=f.missing.world}}}var i=0;var j=0;var r=0;for(var p=0;p<f.ranks.length;p++){var m=f.ranks[p];var v=rankings.persons[A[m.id]];var o=rankings.countries[t[v.country]];if(m.id.startsWith("FAKE")){i++}if((c=="XX"||o.continent==c)&&(s=="XX"||o.id==s)){var n=rankings.competitions[u[m.competition]];j++;if(n.age<=91){y+='<tr class="highlight">'}else{y+="<tr>"}if(m.id.startsWith("FAKE")){i--;w--}if(m.best!=r){var z=0;if(i>0){z=j+k*i}else{z=j+k*(m.rank-p-1)}y+='<td class="rank">'+z.toFixed(0)+"</td>"}else{y+='<td class="rank"></td>'}var x=v.name;if(!m.id.startsWith("FAKE")){x='<a target="_blank" href="https://www.worldcubeassociation.org/persons/'+m.id+"?event="+l+'">'+v.name+"</a>"}if(q>=IPHONE_LANDSCAPE){y+="<td>"+x+(m.hasOwnProperty("age")?", "+m.age+"+":"")+"</td>";y+='<td class="result">'+m.best+"</td>";if(!m.id.startsWith("FAKE")){y+='<td><i class="flag flag-'+o.id+'"></i>&nbsp;'+o.name+"</td>"}else{y+="<td></td>"}if(q>=IPAD_LANDSCAPE){var b=rankings.countries[t[n.country]];if(!m.id.startsWith("FAKE")){y+='<td><i class="flag flag-'+b.id+'"></i>&nbsp;<a target="_blank" href="https://www.worldcubeassociation.org/competitions/'+n.webId+"/results/by_person#"+v.id+'">'+n.name+"</a></td>"}else{y+="<td></td>"}}}else{if(!m.id.startsWith("FAKE")){y+="<td>"+x+'<br/><i class="flag flag-'+o.id+'"></i>&nbsp;'+o.name+(m.hasOwnProperty("age")?", "+m.age+"+":"")+"</td>"}else{y+="<td>"+x+"</td>"}y+='<td class="result">'+m.best+"</td>"}y+="</tr>";r=m.best}}y+="</table></div>";if(w>=0){y+="<p>"+j+" of "+(j+w)+" seniors listed.</p>";y+="<p>Overall completeness of rankings = "+(100*j/(j+w)).toFixed(1)+"%</p>"}else{y+="<p>"+j+" seniors listed.</p>";y+="<p>NOTE: The actual number of seniors for this region is unknown.</p>"}}}return y}function renderRankings(b,c){var e="";var j=getEventIdx();var a=b[0].length>0?b[0]:rankings.events[0].id;var g=b.length>1&&b[1].length>0?b[1].toLowerCase():"single";var f=b.length>2&&b[2].length>0?b[2]:"40";var d=b.length>3&&b[3].length>0?b[3].toUpperCase():"XX";var i=b.length>4&&b[4].length>0?b[4].toUpperCase():"XX";if(j.hasOwnProperty(a)>=0){var h=rankings.events[j[a]];document.title=h.name+" - Over "+f+"s";e+=header();e+=renderOptions(a,g,f,d,i,c);e+=renderTable(a,g,f,d,i,c);e+=footer()}else{e+=parameterMessage("event",a)}document.getElementById("title").innerHTML=document.title;document.getElementById("refreshed").innerHTML=rankings.refreshed;document.getElementById("container").innerHTML=e};